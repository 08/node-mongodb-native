
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Collections &mdash; MongoDB Node.JS Driver 0.9.8.7 documentation</title>
    
    <link rel="stylesheet" href="../_static/mongodb-docs.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.8.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="MongoDB Node.JS Driver 0.9.8.7 documentation" href="../index.html" />
    <link rel="next" title="Inserting and updating" href="insert.html" />
    <link rel="prev" title="Replicasets" href="replicaset.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="insert.html" title="Inserting and updating"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="replicaset.html" title="Replicasets"
             accesskey="P">previous</a> |</li>
        <li><a href="../contents.html">MongoDB Node.JS Driver 0.9.8.7 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="collections">
<h1>Collections<a class="headerlink" href="#collections" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>See also:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="database.html">Database</a></li>
<li><a class="reference external" href="queries.html">Queries</a></li>
</ul>
</div></blockquote>
</div></blockquote>
<div class="section" id="collection-objects">
<h2>Collection objects<a class="headerlink" href="#collection-objects" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Collection object is a pointer to a specific collection in the  <a class="reference external" href="database.html">database</a> . If you want to  <a class="reference external" href="insert.html">insert</a>  new records or
<a class="reference external" href="queries.html">query</a>  existing ones then you need to have a valid collection object.</p>
<p><strong>NB</strong>  Collection names can&#8217;t start or end with a period nor contain a dollar sign! ( <tt class="docutils literal"><span class="pre">.tes$t</span></tt>  is not allowed)</p>
</div></blockquote>
</div>
<div class="section" id="creating-collections">
<h2>Creating collections<a class="headerlink" href="#creating-collections" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Collections can be created with  <tt class="docutils literal"><span class="pre">createCollection</span></tt></p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">createCollection</span><span class="p">([[</span><span class="nx">name</span><span class="p">[,</span> <span class="nx">options</span><span class="p">]],</span> <span class="nx">callback</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>where  <tt class="docutils literal"><span class="pre">name</span></tt>  is the name of the collection, options a set of configuration parameters and  <tt class="docutils literal"><span class="pre">callback</span></tt>  is a callback function.  <tt class="docutils literal"><span class="pre">db</span></tt>  is the database object.</p>
<p>The first parameter for the callback is the error object (null if no error) and the second one is the pointer to the newly created collection. If strict mode is on and the table exists, the operation yields in error. With strict mode off (default) the function simple returns the pointer to the existing collection and does not truncate it.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">createCollection</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">collection</span><span class="p">){</span>
    <span class="nx">collection</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="s2">&quot;test&quot;</span><span class="o">:</span><span class="s2">&quot;value&quot;</span><span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="creating-collections-options">
<h2>Creating collections options<a class="headerlink" href="#creating-collections-options" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Several options can be passed to the  <tt class="docutils literal"><span class="pre">createCollection</span></tt>  function with  <tt class="docutils literal"><span class="pre">options</span></tt>  parameter.</p>
<blockquote>
<div><div class="highlight-javascript"><pre>* `raw` - driver returns documents as bson binary Buffer objects, `default:false`</pre>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">collectionName</span></tt>  is the name of the collection (not including the database name as a prefix)</li>
<li><tt class="docutils literal"><span class="pre">db</span></tt>  is the pointer to the corresponding databse object</li>
</ul>
</div></blockquote>
<p>Example of usage:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Collection name: &quot;</span><span class="o">+</span><span class="nx">collection</span><span class="p">.</span><span class="nx">collectionName</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="list-existing-collections">
<h2>List existing collections<a class="headerlink" href="#list-existing-collections" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Collections can be listed with  <tt class="docutils literal"><span class="pre">collectionNames</span></tt></p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">collectionNames</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">callback</span></tt>  gets two parameters - an error object (if error occured) and an array of collection names as strings.</p>
<p>Collection names also include database name, so a collection named  <tt class="docutils literal"><span class="pre">posts</span></tt>  in a database  <tt class="docutils literal"><span class="pre">blog</span></tt>  will be listed as  <tt class="docutils literal"><span class="pre">blog.posts</span></tt> .</p>
<p>Additionally there&#8217;s system collections which should not be altered without knowing exactly what you are doing, these sollections can be identified with  <tt class="docutils literal"><span class="pre">system</span></tt>  prefix. For example  <tt class="docutils literal"><span class="pre">posts.system.indexes</span></tt> .</p>
<p>Example:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">mongodb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;mongodb&quot;</span><span class="p">),</span>
    <span class="nx">mongoserver</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mongodb</span><span class="p">.</span><span class="nx">Server</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">),</span>
    <span class="nx">db_connector</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mongodb</span><span class="p">.</span><span class="nx">Db</span><span class="p">(</span><span class="s2">&quot;blog&quot;</span><span class="p">,</span> <span class="nx">mongoserver</span><span class="p">);</span>

<span class="nx">db_connector</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">db</span><span class="p">){</span>
    <span class="nx">db</span><span class="p">.</span><span class="nx">collectionNames</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">collections</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">collections</span><span class="p">);</span> <span class="c1">// [&quot;blog.posts&quot;, &quot;blog.system.indexes&quot;]</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="list-collections">
<h2>List collections<a class="headerlink" href="#list-collections" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Collection objects can be listed with database method  <tt class="docutils literal"><span class="pre">collections</span></tt></p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">collections</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Where  <tt class="docutils literal"><span class="pre">callback</span></tt>  gets two parameters - an error object (if an error occured) and an array of collection objects.</p>
</div></blockquote>
</div>
<div class="section" id="selecting-collections">
<h2>Selecting collections<a class="headerlink" href="#selecting-collections" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Existing collections can be opened with  <tt class="docutils literal"><span class="pre">collection</span></tt></p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">collection</span><span class="p">([[</span><span class="nx">name</span><span class="p">[,</span> <span class="nx">options</span><span class="p">]],</span> <span class="nx">callback</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>If strict mode is off, then a new collection is created if not already present.</p>
</div></blockquote>
</div>
<div class="section" id="selecting-collections-options">
<h2>Selecting collections options<a class="headerlink" href="#selecting-collections-options" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Several options can be passed to the  <tt class="docutils literal"><span class="pre">collection</span></tt>  function with  <tt class="docutils literal"><span class="pre">options</span></tt>  parameter.</p>
<blockquote>
<div><div class="highlight-javascript"><pre>* `raw` - driver returns documents as bson binary Buffer objects, `default:false`</pre>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="renaming-collections">
<h2>Renaming collections<a class="headerlink" href="#renaming-collections" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>A collection can be renamed with collection method  <tt class="docutils literal"><span class="pre">rename</span></tt></p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">collection</span><span class="p">.</span><span class="nx">rename</span><span class="p">(</span><span class="nx">new_name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="removing-records-from-collections">
<h2>Removing records from collections<a class="headerlink" href="#removing-records-from-collections" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Records can be erased from a collection with  <tt class="docutils literal"><span class="pre">remove</span></tt></p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">collection</span><span class="p">.</span><span class="nx">remove</span><span class="p">([[</span><span class="nx">query</span><span class="p">[,</span> <span class="nx">options</span><span class="p">]],</span> <span class="nx">callback</span><span class="p">]);</span>
</pre></div>
</div>
</div></blockquote>
<p>Where</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">query</span></tt>  is the query that records to be removed need to match. If not set all records will be removed</li>
<li><tt class="docutils literal"><span class="pre">options</span></tt>  indicate advanced options. For example use  <tt class="docutils literal"><span class="pre">{safe:</span> <span class="pre">true}</span></tt>  when using callbacks</li>
<li><tt class="docutils literal"><span class="pre">callback</span></tt>  callback function that gets two parameters - an error object (if an error occured) and the count of removed records</li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="removing-collections">
<h2>Removing collections<a class="headerlink" href="#removing-collections" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>A collection can be dropped with  <tt class="docutils literal"><span class="pre">drop</span></tt></p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">collection</span><span class="p">.</span><span class="nx">drop</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>or with  <tt class="docutils literal"><span class="pre">dropCollection</span></tt></p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">dropCollection</span><span class="p">(</span><span class="nx">collection_name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo-mongodb.png" alt="Logo"/>
            </a></p>
<h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Collections</a><ul>
<li><a class="reference internal" href="#collection-objects">Collection objects</a></li>
<li><a class="reference internal" href="#creating-collections">Creating collections</a></li>
<li><a class="reference internal" href="#creating-collections-options">Creating collections options</a></li>
<li><a class="reference internal" href="#list-existing-collections">List existing collections</a></li>
<li><a class="reference internal" href="#list-collections">List collections</a></li>
<li><a class="reference internal" href="#selecting-collections">Selecting collections</a></li>
<li><a class="reference internal" href="#selecting-collections-options">Selecting collections options</a></li>
<li><a class="reference internal" href="#renaming-collections">Renaming collections</a></li>
<li><a class="reference internal" href="#removing-records-from-collections">Removing records from collections</a></li>
<li><a class="reference internal" href="#removing-collections">Removing collections</a></li>
</ul>
</li>
</ul>


<h3><a href="../contents.html">Core Documentation</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="database.html">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="replicaset.html">Replicasets</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Collections</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#collection-objects">Collection objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-collections">Creating collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-collections-options">Creating collections options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#list-existing-collections">List existing collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#list-collections">List collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#selecting-collections">Selecting collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#selecting-collections-options">Selecting collections options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#renaming-collections">Renaming collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#removing-records-from-collections">Removing records from collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#removing-collections">Removing collections</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="insert.html">Inserting and updating</a></li>
<li class="toctree-l1"><a class="reference internal" href="queries.html">Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="indexes.html">Indexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="gridfs.html">GridStore</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/markdown-docs/collections.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
  <h4>Previous page</h4>
  <p class="topless"><a href="replicaset.html"
                        title="previous chapter">Replicasets</a></p>
  <h4>Next page</h4>
  <p class="topless"><a href="insert.html"
                        title="next chapter">Inserting and updating</a></p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="insert.html" title="Inserting and updating"
             >next</a> |</li>
        <li class="right" >
          <a href="replicaset.html" title="Replicasets"
             >previous</a> |</li>
        <li><a href="../contents.html">MongoDB Node.JS Driver 0.9.8.7 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, MongoDB Node.JS Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-7301842-7']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    <script type="text/javascript">
      document.write(unescape("%3Cscript src='" + document.location.protocol + "//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script>try { mktoMunchkin("017-HGS-593"); } catch(e) {}</script>
  </body>
</html>