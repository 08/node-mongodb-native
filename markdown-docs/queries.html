
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Queries &mdash; MongoDB Node.JS Driver 0.9.9.5 documentation</title>
    
    <link rel="stylesheet" href="../_static/mongodb-docs.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.9.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="MongoDB Node.JS Driver 0.9.9.5 documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../contents.html">MongoDB Node.JS Driver 0.9.9.5 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="queries">
<h1>Queries<a class="headerlink" href="#queries" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>See also:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="database.html">Database</a></li>
<li><a class="reference external" href="collections.html">Collections</a></li>
</ul>
</div></blockquote>
</div></blockquote>
<div class="section" id="making-queries-with-find">
<h2>Making queries with find()<a class="headerlink" href="#making-queries-with-find" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p><a class="reference external" href="collections.html">Collections</a>  can be queried with  <tt class="docutils literal"><span class="pre">find</span></tt> .</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">collection</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">[[[,</span> <span class="nx">fields</span><span class="p">],</span> <span class="nx">options</span><span class="p">],</span> <span class="nx">callback</span><span class="p">]);</span>
</pre></div>
</div>
</div></blockquote>
<p>Where</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">query</span></tt>  - is a query object, defining the conditions the documents need to apply</li>
<li><tt class="docutils literal"><span class="pre">fields</span></tt>  - indicates which fields should be included in the response (default is all)</li>
<li><tt class="docutils literal"><span class="pre">options</span></tt>  - defines extra logic (sorting options, paging etc.)</li>
<li><tt class="docutils literal"><span class="pre">raw</span></tt>  - driver returns documents as bson binary Buffer objects,  <tt class="docutils literal"><span class="pre">default:false</span></tt></li>
</ul>
</div></blockquote>
<p>The result for the query is actually a cursor object. This can be used directly or converted to an array.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">cursor</span> <span class="o">=</span> <span class="nx">collection</span><span class="p">.</span><span class="nx">find</span><span class="p">({});</span>
<span class="nx">cursor</span><span class="p">.</span><span class="nx">each</span><span class="p">(...);</span>
</pre></div>
</div>
</div></blockquote>
<p>To indicate which fields must or must no be returned  <tt class="docutils literal"><span class="pre">fields</span></tt>  value can be used. For example the following  <tt class="docutils literal"><span class="pre">fields</span></tt>  value</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>retrieves fields  <tt class="docutils literal"><span class="pre">name</span></tt>  and  <tt class="docutils literal"><span class="pre">title</span></tt>  (and as a default also  <tt class="docutils literal"><span class="pre">_id</span></tt> ) but not any others.</p>
</div></blockquote>
</div>
<div class="section" id="find-first-occurence-with-findone">
<h2>Find first occurence with findOne()<a class="headerlink" href="#find-first-occurence-with-findone" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">findOne</span></tt>  is a convinence method finding and returning the first match of a query while regular  <tt class="docutils literal"><span class="pre">find</span></tt>  returns a cursor object instead. Use it when you expect only one record, for example when querying with  <tt class="docutils literal"><span class="pre">_id</span></tt>  or another unique property.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">collection</span><span class="p">.</span><span class="nx">findOne</span><span class="p">([</span><span class="nx">query</span><span class="p">],</span> <span class="nx">callback</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Where</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">query</span></tt>  is a query object or an  <tt class="docutils literal"><span class="pre">_id</span></tt>  value</li>
<li><tt class="docutils literal"><span class="pre">callback</span></tt>  has two parameters - an error object (if an error occured) and the document object.</li>
</ul>
</div></blockquote>
<p>Example:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">collection</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span><span class="nx">_id</span><span class="o">:</span> <span class="nx">doc_id</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nb">document</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="id-values">
<h2>_id values<a class="headerlink" href="#id-values" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Default  <tt class="docutils literal"><span class="pre">_id</span></tt>  values are 12 byte binary hashes. You can alter the format with custom Primary Key factories (see  <em>Custom Primarky Keys</em>  in  <a class="reference external" href="database.html)">Database</a> .</p>
<p>In order to treat these binary _id values as strings it would be wise to convert binary values to hex strings. This can be done with  <tt class="docutils literal"><span class="pre">toHexString</span></tt>  property.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">idHex</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">_id</span><span class="p">.</span><span class="nx">toHexString</span><span class="p">();</span>
</pre></div>
</div>
</div></blockquote>
<p>Hex strings can be reverted back to binary (for example to perform queries) with  <tt class="docutils literal"><span class="pre">ObjectID.createFromHexString</span></tt></p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="nx">_id</span><span class="o">:</span> <span class="nx">ObjectID</span><span class="p">.</span><span class="nx">createFromHexString</span><span class="p">(</span><span class="nx">idHex</span><span class="p">)}</span>
</pre></div>
</div>
</div></blockquote>
<p>When inserting new records it is possible to use custom  <tt class="docutils literal"><span class="pre">_id</span></tt>  values as well which do not need to be binary hashes, for example strings.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">collection</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="nx">_id</span><span class="o">:</span> <span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="p">...});</span>
<span class="nx">collection</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span><span class="nx">_id</span><span class="o">:</span> <span class="s2">&quot;abc&quot;</span><span class="p">},...);</span>
</pre></div>
</div>
</div></blockquote>
<p>This way it is not necessary to convert  <tt class="docutils literal"><span class="pre">_id</span></tt>  values to hex strings and back.</p>
</div></blockquote>
</div>
<div class="section" id="query-object">
<h2>Query object<a class="headerlink" href="#query-object" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The simplest query object is an empty one  <tt class="docutils literal"><span class="pre">{}</span></tt>  which matches every record in the database.</p>
<p>To make a simple query where one field must match to a defined value, one can do it as simply as</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="nx">fieldname</span><span class="o">:</span> <span class="s2">&quot;fieldvalue&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>This query matches all the records that a) have fields called  <em>fieldname</em>  and b) its value is  <em>&#8220;fieldvalue&#8221;</em> .</p>
<p>For example if we have a collection of blog posts where the structure of the records is  <tt class="docutils literal"><span class="pre">{title,</span> <span class="pre">author,</span> <span class="pre">contents}</span></tt>  and we want to retrieve all the posts for a specific author then we can do it like this:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">posts</span> <span class="o">=</span> <span class="nx">pointer_to_collection</span><span class="p">;</span>
<span class="nx">posts</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">author</span><span class="o">:</span><span class="s2">&quot;Daniel&quot;</span><span class="p">}).</span><span class="nx">toArray</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">results</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">);</span> <span class="c1">// output all records</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
<p>If the queried field is inside an object then that can be queried also. For example if we have a record with the following structure:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">user</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Daniel&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Then we can query the &#8220;name&#8221; field like this:  <tt class="docutils literal"><span class="pre">{&quot;user.name&quot;:&quot;Daniel&quot;}</span></tt></p>
<p>If more than one fieldname is specified, then it&#8217;s an AND query</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">key1</span><span class="o">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span>
    <span class="nx">name2</span><span class="o">:</span> <span class="s2">&quot;value2&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Whis query matches all records where  <em>key1</em>  is  <em>&#8220;value1&#8221;</em>  and   <em>key2</em>  is  <em>&#8220;value2&#8221;</em></p>
<p>OR queries are a bit trickier but doable with the  <tt class="docutils literal"><span class="pre">$or</span></tt>  operator. Query operator takes an array which includes a set of query objects and at least one of these must match a document before it is retrieved</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">$or</span><span class="o">:</span><span class="p">[</span>
        <span class="p">{</span><span class="nx">author</span><span class="o">:</span><span class="s2">&quot;Daniel&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">author</span><span class="o">:</span><span class="s2">&quot;Jessica&quot;</span><span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>This query match all the documents where author is Daniel or Jessica.</p>
<p>To mix AND and OR queries, you just need to use $or as one of regular query fields.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">title</span><span class="o">:</span><span class="s2">&quot;MongoDB&quot;</span><span class="p">,</span>
    <span class="nx">$or</span><span class="o">:</span><span class="p">[</span>
        <span class="p">{</span><span class="nx">author</span><span class="o">:</span><span class="s2">&quot;Daniel&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">author</span><span class="o">:</span><span class="s2">&quot;Jessica&quot;</span><span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Conditional operators  <tt class="docutils literal"><span class="pre">&lt;</span></tt> ,  <tt class="docutils literal"><span class="pre">&lt;=</span></tt> ,  <tt class="docutils literal"><span class="pre">&gt;</span></tt> ,  <tt class="docutils literal"><span class="pre">&gt;=</span></tt>  and  <tt class="docutils literal"><span class="pre">!=</span></tt>  can&#8217;t be used directly, as the query object format doesn&#8217;t support it but the same can be achieved with their aliases  <tt class="docutils literal"><span class="pre">$lt</span></tt> ,  <tt class="docutils literal"><span class="pre">$lte</span></tt> ,  <tt class="docutils literal"><span class="pre">$gt</span></tt> ,  <tt class="docutils literal"><span class="pre">$gte</span></tt>  and  <tt class="docutils literal"><span class="pre">$ne</span></tt> . When a field value needs to match a conditional, the value must be wrapped into a separate object.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;fieldname&quot;</span><span class="o">:</span><span class="p">{</span><span class="nx">$gte</span><span class="o">:</span><span class="mi">100</span><span class="p">}}</span>
</pre></div>
</div>
</div></blockquote>
<p>This query defines that  <em>fieldname</em>  must be greater than or equal to  <tt class="docutils literal"><span class="pre">100</span></tt> .</p>
<p>Conditionals can also be mixed to create ranges.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;fieldname&quot;</span><span class="o">:</span> <span class="p">{</span><span class="nx">$lte</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span> <span class="nx">$gte</span><span class="o">:</span><span class="mi">100</span><span class="p">}}</span>
</pre></div>
</div>
</div></blockquote>
<p>Queried field values can also be matched with regular expressions</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="nx">author</span><span class="o">:</span><span class="sr">/^Daniel/</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>In addition to OR and conditional there&#8217;s some more operators:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">$in</span></tt>  - specifies an array of possible matches,  <tt class="docutils literal"><span class="pre">{&quot;name&quot;:{$in:[1,2,3]}}</span></tt></li>
<li><tt class="docutils literal"><span class="pre">$nin</span></tt>  - specifies an array of unwanted matches</li>
<li><tt class="docutils literal"><span class="pre">$all</span></tt>  - array value must match to the condition  <tt class="docutils literal"><span class="pre">{&quot;name&quot;:{$all:[1,2,3]}}</span></tt></li>
<li><tt class="docutils literal"><span class="pre">$exists</span></tt>  - checks for existence of a field  <tt class="docutils literal"><span class="pre">{&quot;name&quot;:{$exists:true}}</span></tt></li>
<li><tt class="docutils literal"><span class="pre">$mod</span></tt>  - check for a modulo  <tt class="docutils literal"><span class="pre">{&quot;name&quot;:{$mod:{3,2}}</span></tt>  is the same as  <tt class="docutils literal"><span class="pre">&quot;name&quot;</span> <span class="pre">%</span> <span class="pre">3</span> <span class="pre">==</span> <span class="pre">2</span></tt></li>
<li><tt class="docutils literal"><span class="pre">$size</span></tt>  - checks the size of an array value  <tt class="docutils literal"><span class="pre">{&quot;name&quot;:</span> <span class="pre">{$size:2}}</span></tt>  matches arrays  <em>name</em>  with 2 elements</li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="queries-inside-objects-and-arrays">
<h2>Queries inside objects and arrays<a class="headerlink" href="#queries-inside-objects-and-arrays" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>If you have a document with nested objects/arrays then the keys inside these nested objects can still be used for queries.</p>
<p>For example with the following document</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="nx">idvalue</span><span class="p">,</span>
    <span class="s2">&quot;author&quot;</span><span class="o">:</span><span class="p">{</span>
        <span class="s2">&quot;firstname&quot;</span><span class="o">:</span><span class="s2">&quot;Daniel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastname&quot;</span><span class="o">:</span> <span class="s2">&quot;Defoe&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;books&quot;</span><span class="o">:</span><span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;title&quot;</span><span class="o">:</span><span class="s2">&quot;Robinson Crusoe&quot;</span>
            <span class="s2">&quot;year&quot;</span><span class="o">:</span> <span class="mi">1714</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>not only the  <tt class="docutils literal"><span class="pre">_id</span></tt>  field can be used as a query field - also the  <tt class="docutils literal"><span class="pre">firstname</span></tt>  and even  <tt class="docutils literal"><span class="pre">title</span></tt>  can be used. This can be done when using nested field names as strings, concated with periods.</p>
<blockquote>
<div><div class="highlight-javascript"><pre>collection.find({"author.firstname":"Daniel})</pre>
</div>
</div></blockquote>
<p>Works even inside arrays</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">collection</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s2">&quot;books.year&quot;</span><span class="o">:</span><span class="mi">1714</span><span class="p">})</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="query-options">
<h2>Query options<a class="headerlink" href="#query-options" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Query options define the behavior of the query.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;limit&quot;</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;skip&quot;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;sort&quot;</span><span class="o">:</span> <span class="nx">title</span>
<span class="p">}</span>

<span class="nx">collection</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="nx">options</span><span class="p">).</span><span class="nx">toArray</span><span class="p">(...);</span>
</pre></div>
</div>
</div></blockquote>
<p>Paging can be achieved with option parameters  <tt class="docutils literal"><span class="pre">limit</span></tt>  and  <tt class="docutils literal"><span class="pre">skip</span></tt></p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;limit&quot;</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;skip&quot;</span> <span class="mi">10</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>retrieves 10 elements starting from 20</p>
<p>Sorting can be acieved with option parameter  <tt class="docutils literal"><span class="pre">sort</span></tt>  which takes an array of sort preferences</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;sort&quot;</span><span class="o">:</span> <span class="p">[[</span><span class="s1">&#39;field1&#39;</span><span class="p">,</span><span class="s1">&#39;asc&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;field2&#39;</span><span class="p">,</span><span class="s1">&#39;desc&#39;</span><span class="p">]]</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>With single ascending field the array can be replaced with the name of the field.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;sort&quot;</span><span class="o">:</span> <span class="s2">&quot;name&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Option parameter  <tt class="docutils literal"><span class="pre">explain</span></tt>  turns the query into an explain query.</p>
</div></blockquote>
</div>
<div class="section" id="cursors">
<h2>Cursors<a class="headerlink" href="#cursors" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Cursor objects are the results for queries and can be used to fetch individual fields from the database.</p>
<p><tt class="docutils literal"><span class="pre">cursor.nextObject(function(err,</span> <span class="pre">doc){})</span></tt>  retrieves the next record from database. If doc is null, then there weren&#8217;t any more records.</p>
<p><tt class="docutils literal"><span class="pre">cursor.each(function(err,</span> <span class="pre">doc){})</span></tt>  retrieves all matching records one by one.</p>
<p><tt class="docutils literal"><span class="pre">cursor.toArray(function(err,</span> <span class="pre">docs){})</span></tt>  converts the cursor object into an array of all the matching records. Probably the most convenient way to retrieve results but be careful with large datasets as every record is loaded into memory.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">collection</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">toArray</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">docs</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;retrieved records:&quot;</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">docs</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">cursor.rewind()</span></tt>  resets the internal pointer in the cursor to the beginning.</p>
</div></blockquote>
</div>
<div class="section" id="counting-matches">
<h2>Counting matches<a class="headerlink" href="#counting-matches" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Counting total number of found matches can be done against cursors with method  <tt class="docutils literal"><span class="pre">count</span></tt> .</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">cursor</span><span class="p">.</span><span class="nx">count</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Where</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">callback</span></tt>  is the callback function with two parameters - an error object (if an error occured) and the number on matches as an integer.</li>
</ul>
</div></blockquote>
<p>Example</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">cursor</span><span class="p">.</span><span class="nx">count</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">count</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Total matches: &quot;</span><span class="o">+</span><span class="nx">count</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo-mongodb.png" alt="Logo"/>
            </a></p>
<h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Queries</a><ul>
<li><a class="reference internal" href="#making-queries-with-find">Making queries with find()</a></li>
<li><a class="reference internal" href="#find-first-occurence-with-findone">Find first occurence with findOne()</a></li>
<li><a class="reference internal" href="#id-values">_id values</a></li>
<li><a class="reference internal" href="#query-object">Query object</a></li>
<li><a class="reference internal" href="#queries-inside-objects-and-arrays">Queries inside objects and arrays</a></li>
<li><a class="reference internal" href="#query-options">Query options</a></li>
<li><a class="reference internal" href="#cursors">Cursors</a></li>
<li><a class="reference internal" href="#counting-matches">Counting matches</a></li>
</ul>
</li>
</ul>


<h3><a href="../contents.html">Core Documentation</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api-generated/db.html">Db()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-generated/collection.html">Collection()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-generated/admin.html">Admin()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-generated/cursor.html">Cursor()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-generated/cursorstream.html">CursorStream()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-generated/grid.html">Grid()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-generated/gridstore.html">GridStore()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-generated/readstream.html">ReadStream()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-bson-generated/bson.html">BSON()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-bson-generated/objectid.html">ObjectID()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-bson-generated/binary.html">Binary()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-bson-generated/code.html">DBRef()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-bson-generated/double.html">Double()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-bson-generated/long.html">Long()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-bson-generated/timestamp.html">Timestamp()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-bson-generated/maxkey.html">MaxKey()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-bson-generated/symbol.html">Symbol()</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/markdown-docs/queries.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../contents.html">MongoDB Node.JS Driver 0.9.9.5 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, MongoDB Node.JS Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>

    <script type="text/javascript">
      document.write(unescape("%3Cscript src='" + document.location.protocol + "//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script>try { mktoMunchkin("017-HGS-593"); } catch(e) {}</script>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-29229787-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>